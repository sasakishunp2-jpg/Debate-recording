<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Debate Audio Search</title>
    <link rel="stylesheet" href="https://pyscript.net/releases/2024.1.1/core.css">
    <script type="module" src="https://pyscript.net/releases/2024.1.1/core.js"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
        input { padding: 8px; width: 250px; }
        button { padding: 8px 15px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; }
        #output { margin-top: 20px; white-space: pre-wrap; background: #f8f9fa; padding: 15px; border-radius: 5px; }
        .url-link { color: #007bff; text-decoration: none; display: block; margin-bottom: 5px; }
    </style>
</head>
<body>

    <h2>ãƒ‡ã‚£ãƒ™ãƒ¼ãƒˆéŸ³æºæ¤œç´¢ãƒ„ãƒ¼ãƒ« </h2>
    <p>ã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆEconomy, Educationãªã©ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼š</p>
    
    <input type="text" id="category-input" placeholder="ä¾‹: Economy">
    <button py-click="search_videos">æ¤œç´¢</button>

    <div id="output"></div>

    <script type="py">
        from pyscript import document
        import csv

        def search_videos(event):
            target = document.querySelector("#category-input").value.strip().lower()
            output_div = document.querySelector("#output")
            output_div.innerHTML = ""
            
            if not target:
                output_div.innerText = "ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚"
                return

            results_found = False
            
            # CSVãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç›´æ¥èª­ã¿è¾¼ã‚€å‡¦ç†
            try:
                with open("debate_data.csv", mode="r", encoding="utf-8") as f:
                    reader = csv.reader(f)
                    for row in reader:
                        # ç©ºè¡Œã‚’é£›ã°ã™
                        if not row: continue
                        
                        video_id = row[0]
                        category = row[1]

                        if target in category.lower():
                            url = f"https://www.youtube.com/watch?v={video_id}"
                            link_html = f'<a href="{url}" target="_blank" class="url-link">ğŸ”— {url}</a>'
                            output_div.innerHTML += link_html
                            results_found = True
            except Exception as e:
                output_div.innerText = f"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {e}"

            if not results_found:
                output_div.innerText = f"ã€Œ{target}ã€ã«è©²å½“ã™ã‚‹å‹•ç”»ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
    </script>

</body>
</html>